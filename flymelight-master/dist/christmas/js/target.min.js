/*! web - christmas - v1.0.0 - fldevteam - 2015-03-06 */
$(function(){$(".pack").css("minHeight",$(window).height()),$(".giftevent .view").on("click",function(){var a=$(this).attr("data-val");if($(".codetext").hide(),$(".prz-ico").attr("class","prz-ico").addClass("prz-gift"+a),$(".giftshow .name").html($(this).siblings(".przname").val()),4==a||5==a)return $(".giftshow .text").hide(),$("#overlay").show(),!1;var b=$(this).siblings(".general").text();if($(".codetext .code").text(""),b)$(".generalc .code").text(b),$(".generalc, #overlay").show();else{var c=$(this).siblings(".appcode").text(),d=$(this).siblings(".ipacode").text();$(".appc .code").text(c),$(".ipac .code").text(d),$(".appc, .ipac, #overlay").show()}}),$(".giftshow .confirm, .giftclose").on("click",function(){$("#overlay").hide()}),$(".popup .confirm").on("click",function(){$("#overlay").hide(),$(".creditsleft .cred").text()>0&&("确定"==$(".popup-inner .confirm").text()?$("#overlay").hide():$(".slotbtn").trigger("click"))})}),$(function(){$(".lot").css("minHeight",$(window).height()),$(window).resize(function(){$(".lot").css("minHeight",$(window).height())});var a=!1;$(".giftshow .confirm, .giftclose").on("click",function(){$("#overlay").hide()}),$(".popup .confirm").on("click",function(){$("#overlay").hide(),$(".creditsleft .cred").text()>0&&("确定"==$(".popup-inner .confirm").text()?$("#overlay").hide():(a=!0,$(".slotbtn").trigger("click")))});var b=!0;$("#slotbtn").click(function(){function c(a,b){switch(a[0].id){case"machine1":$("#machine1Result").text("Index: "+b.index);break;case"machine2":$("#machine2Result").text("Index: "+b.index);break;case"machine3":$("#machine3Result").text("Index: "+b.index)}}if(b){b=!1;var d={stat:-1,result:[1,3,8],prizeCode:"A003",prizeName:"",creditsleft:180,timesleft:0,prizeTotalCount:3,tips:"很遗憾",creditsConsume:20,creditsTips:"今天赠送的抽奖机会已用完<br>花20积分再来一次吗？"};if(!d.timesleft&&!a)return $(".popup .tipstxt").html(d.creditsTips),$("#overlay").show(),b=!0,d.creditsleft<d.creditsConsume?("确定"==$(".popup-inner .confirm").text()&&$("#overlay").hide(),$(".popup .tipstxt").html("本次抽奖需要消耗"+d.creditsConsume+"积分<br>快去赚积分吧~"),$(".popup-inner .confirm").text("确定"),$("#overlay").show(),b=!0,!1):!1;d.prizeTotalCount||$(".lot-pack").html('<img class="lot-btm-img" src="images/backpack_small.png" alt="我的背包">');var e=$("#machine1").slotMachine({active:0,delay:500,stopIndex:d.result[0]}),f=$("#machine2").slotMachine({active:1,delay:500,stopIndex:d.result[1]}),g=$("#machine3").slotMachine({active:2,delay:500,stopIndex:d.result[2]});e.shuffle(3,c),setTimeout(function(){f.shuffle(3,c)},500),setTimeout(function(){g.shuffle(3,c)},1e3),$(".creditsleft .cred").html(d.creditsleft),$(".timesleft").html(d.timesleft),setTimeout(function(){-1==d.stat?($(".stat").hide(),$(".stat-failure").show()):0==d.stat?($("#prizename").html(d.prizeName),$(".stat").hide(),$(".stat-success").show()):(alert(d.tips),$(".stat").hide(),$(".stat-default").show()),b=!0,a=!1},3e3)}})});